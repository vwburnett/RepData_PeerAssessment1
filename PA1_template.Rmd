---
title: 'Coursera: Reproducible Research Week2 Project'
author: "Van Wyk Burnett"
date: "06 November 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Project overview
This project will analyse movement data taken from an activity monitoring device of an anonymous individual. The device collects data at 5 minute intervals through out the day, the data that is collected is the steps taken by the individual every 5 minutes.The data that was made available for this project contain data for two months (October and November, 2012).

##Importing data to R
```{r read file, echo = TRUE}
#Name File
filename <- "repdata_data_activity.zip"

#Unzipfile
if(!file.exists("activity.csv")){
  unzip(filename)
}

#Read csv into R
activitydata <- read.csv("activity.csv")
```

##Loading R packaged that will be used
```{r load packages, echo=TRUE}
library(ggplot2)
library(plyr)
library(lattice)
```

##Steps Analysis 1
The number of steps taken by the individual on each day.
```{r histogram 1, echo=TRUE}
#convert date to weekdays
activitydata$day <- weekdays(as.Date(activitydata$date))
activitydata$DateTime<- as.POSIXct(activitydata$date, format="%Y-%m-%d")
#remove missing values
cleaned <- activitydata[!is.na(activitydata$steps),]
#create a table with total steps per day
sumTable <- aggregate(activitydata$steps ~ activitydata$date, FUN=sum)
colnames(sumTable)<- c("Date", "Steps")
#histogram with total number of steps taken each day
hist(sumTable$Steps, breaks=5, xlab="Steps", main = "Total Steps per Day")
```

The mean and median of steps taken each day.
```{r mean and median, echo=TRUE}
#mean number of steps taken per day
as.integer(mean(sumTable$Steps))

## Median of Steps taken per day
as.integer(median(sumTable$Steps))
```

##Time Series Analysis
Time series plot of the average number of steps taken.
```{r time series, echo=TRUE}
##create average number of steps per interval
intervalTable <- ddply(cleaned, .(interval), summarize, Avg = mean(steps))

##Create line plot of average number of steps per interval
p <- ggplot(intervalTable, aes(x=interval, y=Avg), xlab = "Interval", ylab="Average Number of Steps")
p + geom_line()+xlab("Interval")+ylab("Average Number of Steps")+ggtitle("Average Number of Steps per Interval")
```

The 5-minute interval that, on average, contains the maximum number of steps.
```{r max steps, echo-TRUE}
##Maximum steps by interval
maxSteps <- max(intervalTable$Avg)
##Which interval contains the maximum average number of steps
intervalTable[intervalTable$Avg==maxSteps,1]
```
The 5-minute interval which had the maximum number of steps was the 835 interval.

##Imputing Missing Values
The missing steps were filled with the average number of steps taken on the specific weekday.
```{r imputing, echo=TRUE}
## Create the average number of steps per weekday and interval
avgTable <- ddply(cleaned, .(interval, day), summarize, Avg = mean(steps))

## Create dataset with all NAs for substitution
nadata<- activitydata[is.na(activitydata$steps),]
## Merge NA data with average weekday interval for substitution
newdata<-merge(nadata, avgTable, by=c("interval", "day"))

## Reorder the new substituded data in the same format as clean data set
newdata2<- newdata[,c(6,4,1,2,5)]
colnames(newdata2)<- c("steps", "date", "interval", "day", "DateTime")

##Merge the NA averages and non NA data together
mergeData <- rbind(cleaned, newdata2)
```

The total number of steps taken each day after missing values have been imputed.
```{r histogram, echo=TRUE}
##Create sum of steps per date to compare with step 1
sumTable2 <- aggregate(mergeData$steps ~ mergeData$date, FUN=sum)
colnames(sumTable2)<- c("Date", "Steps")

## Mean of Steps with NA data taken care of
as.integer(mean(sumTable2$Steps))
## Median of Steps with NA data taken care of
as.integer(median(sumTable2$Steps))

## Creating the histogram of total steps per day, categorized by data set to show impact
hist(sumTable2$Steps, breaks=5, xlab="Steps", main = "Total Steps per Day with NAs Imputed", col="Black")
hist(sumTable$Steps, breaks=5, xlab="Steps", main = "Total Steps per Day with NAs Imputed", col="Grey", add=T)
legend("topright", c("Imputed Data", "Non-NA Data"), fill=c("black", "grey") )
```

##Panel Plot
The average number of steps taken per 5-minute interval across weekdays and weekends.
```{r panel plot, echo=TRUE}
## Create new category based on the days of the week
mergeData$DayCategory <- ifelse(mergeData$day %in% c("Saturday", "Sunday"), "Weekend", "Weekday")

## Summarize data by interval and type of day
intervalTable2 <- ddply(mergeData, .(interval, DayCategory), summarize, Avg = mean(steps))

##Plot data in a panel plot
xyplot(Avg~interval|DayCategory, data=intervalTable2, type="l",  layout = c(1,2),
       main="Average Steps per Interval Based on Type of Day", 
       ylab="Average Number of Steps", xlab="Interval")
```